:root{
  --maroon:#8C1D40;
  --gold:#FFC627;
  --ink:#1f2937;
  --muted:#6b7280;
  --bg:#f7f7fb;
  --card:#ffffff;
  --line:#e5e7eb;
  --ok:#eaf7df;
  --warn:#fff3cd;
  --bad:#fde8e8;

  --radius:18px;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--ink);
  background:var(--bg);
  overflow-x:hidden;
}

.topbar{
  width:100%;
  background:linear-gradient(90deg,var(--maroon),#6d1430);
  border-bottom:4px solid var(--gold);
  padding:18px 22px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
}
.brand{display:flex;align-items:center;gap:14px;color:white}
.brand-mark{width:40px;height:40px;border-radius:10px;background:var(--gold)}
.brand-text h1{margin:0;font-size:20px}
.brand-text p{margin:2px 0 0;color:rgba(255,255,255,.85);font-size:13px}
.topbar-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

.wrap{
  width:min(1400px, calc(100vw - 32px));
  margin:18px auto 40px;
  padding:0 12px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:18px;
}

.eyebrow{font-size:11px;letter-spacing:.12em;color:var(--muted);font-weight:700}
.mol-title{font-size:26px;font-weight:800;margin-top:2px}
.muted{color:var(--muted)}
.small{font-size:12px}

h2{margin:0 0 8px;font-size:18px}
.label{font-weight:700;font-size:13px;margin-bottom:6px;display:block}

.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

.input,.select{
  border:1px solid var(--line);
  border-radius:12px;
  padding:10px 12px;
  font-size:14px;
  min-width:220px;
  outline:none;
}
.input:focus,.select:focus{border-color:#c9b3bb;box-shadow:0 0 0 3px rgba(140,29,64,.12)}

.btn{
  border:1px solid transparent;
  border-radius:999px;
  padding:10px 14px;
  font-weight:800;
  cursor:pointer;
  font-size:13px;
  white-space:nowrap;
}
.btn-primary{background:var(--maroon);color:white}
.btn-secondary{background:white;border-color:var(--line);color:var(--ink)}
.btn:disabled{opacity:.45;cursor:not-allowed}

.divider{height:1px;background:var(--line);margin:14px 0}

.msg{
  margin-top:10px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--line);
  font-size:13px;
}
.msg-neutral{background:#f8fafc}
.msg-warn{background:var(--warn);border-color:#f3d180}
.msg-good{background:var(--ok);border-color:#b7de88}
.msg-bad{background:var(--bad);border-color:#f3b0b0}

.card-head-row{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.actions{display:flex;gap:10px;flex-wrap:wrap}

.step1-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
@media (max-width:780px){.step1-grid{grid-template-columns:1fr}}

.panel{
  border:1px solid var(--line);
  border-radius:16px;
  padding:14px;
  background:#fff;
}

.bank .bank-head{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.bank-badges{display:flex;gap:8px}
.badge{
  border:1px solid var(--line);
  border-radius:12px;
  padding:8px 10px;
  min-width:88px;
  text-align:right;
  font-weight:900;
}
.rules{margin:10px 0 0;padding-left:18px;color:var(--muted)}
.rules li{margin:4px 0}

.build-grid{display:grid;grid-template-columns:1.3fr .7fr;gap:14px;margin-top:10px}
@media (max-width:980px){.build-grid{grid-template-columns:1fr}}

.panel-title{font-weight:900;margin-bottom:10px}

/* Stage */
.stage{
  position:relative;
  width:100%;
  height:520px;
  border:2px dashed #e7c5cf;
  border-radius:16px;
  background:linear-gradient(180deg,#fff,#fff6f8);
  overflow:hidden;
}
.bond-svg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  pointer-events:none;
}

/* Atoms */
.atom{
  position:absolute;
  width:60px;height:60px;
  border-radius:16px;
  background:#fff;
  border:2px solid #e3b6c4;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:1000;
  box-shadow:0 8px 20px rgba(0,0,0,.06);
  user-select:none;
  z-index:5;
}
.atom .sym{font-size:18px}

/* Lone pair drop dots (corners only, subtle, NO TEXT) */
.drop-lp{
  position:absolute;
  width:18px;height:18px;
  border-radius:999px;
  border:2px dashed #e7c5cf;
  background:rgba(255,255,255,.75);
  z-index:4;
  font-size:0 !important;
  color:transparent !important;
}
.drop-lp.filled{
  border-style:solid;
  background:#fff;
}
.drop-lp.filled::after{
  content:"••";
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  color:var(--ink);
  letter-spacing:.06em;
}

/* Bond drop zone: ONE pill BETWEEN atoms, rotated to match angle */
.bond-zone{
  position:absolute;
  left:var(--cx);
  top:var(--cy);
  width:var(--w);
  height:44px;
  transform:translate(-50%,-50%) rotate(var(--ang));
  transform-origin:center;
  border-radius:999px;
  border:2px dashed #d9a9b8;
  background:rgba(255,255,255,.9);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:3;
}
.bond-zone .ph{
  font-size:11px;
  letter-spacing:.08em;
  color:rgba(122,43,68,.75);
  font-weight:900;
  text-transform:uppercase;
}
.bond-zone.filled{
  border-style:solid;
  background:#fff;
}
.bond-zone .bondGlyph{
  font-size:22px;
  font-weight:1000;
  line-height:1;
  color:var(--ink);
}

/* Toolbox */
.toolbox .tool-list{display:flex;flex-direction:column;gap:10px}
.tool{
  display:flex;
  gap:12px;
  align-items:center;
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px 12px;
  background:#fff;
  cursor:grab;
}
.tool:active{cursor:grabbing}
.tool-icon{
  width:44px;height:44px;
  border-radius:14px;
  border:1px solid var(--line);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:1000;
}
.tool-name{font-weight:1000}

.hintbox{
  margin-top:12px;
  border:2px dashed #e7c5cf;
  border-radius:16px;
  padding:12px;
  background:#fff7fa;
}
.hint-title{font-weight:1000;margin-bottom:8px}
.hint{margin:0;padding-left:18px;color:var(--muted)}
.hint li{margin:4px 0}

/* Feedback */
.feedback{
  margin-top:14px;
  padding:14px;
  border-radius:16px;
  border:1px solid var(--line);
  background:#f8fafc;
}
.feedback.bad{background:var(--bad);border-color:#f3b0b0}
.feedback.good{background:var(--ok);border-color:#b7de88}
.feedback h3{margin:0 0 8px}
.feedback ul{margin:8px 0 0;padding-left:18px}
